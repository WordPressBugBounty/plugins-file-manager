import{r as F,j as e,a as f,_ as t}from"./main.6.8.6.js";import{r as I}from"./react-vendor-0bea0611.js";import{u as v,a as R}from"./@tanstack/react-query-cb8e8166.js";import{S as _,m as i,B as S,i as w,o as b,c as r,p as h,n as x}from"./antd-b03f4406.js";import"./@emotion/react-f59bf8e1.js";import"./react-router-dom-551725bc.js";import"./@tanstack/react-query-devtools-28f31d30.js";function O(){var m,a,y,p;const{data:l,isLoading:o,isFetching:s}=v({queryKey:["fetch_settings"],queryFn:async()=>F({action:"settings/get",method:"GET"})});return{isLoading:o,isFetching:s,settings:(m=l==null?void 0:l.data)==null?void 0:m.settings,languages:(a=l==null?void 0:l.data)==null?void 0:a.languages,themes:(y=l==null?void 0:l.data)==null?void 0:y.themes,defaults:(p=l==null?void 0:l.data)==null?void 0:p.defaults}}function U(){const{mutateAsync:l,isLoading:o}=R(async s=>F({action:"settings/update",data:s}));return{updateSettings:s=>l(s),isSettingsUpdating:o}}function q(){const{useForm:l}=i,{settings:o,themes:s,languages:m,defaults:a}=O(),{updateSettings:y,isSettingsUpdating:p}=U(),[d]=l();return I.useEffect(()=>{d.setFieldsValue(o)},[o,d]),e(i,{form:d,initialValues:a,colon:!1,onFinish:n=>{y(n).then(c=>{if(c.code==="SUCCESS"){x.success({message:c.message});const u=d.getFieldsError().map(g=>(g.errors&&(g.errors=[]),g));d.setFields(u)}else{const u=[];Object.keys(c.data).forEach(g=>{u.push({name:g.split("."),errors:c.data[g]})}),d.setFields(u)}})},onValuesChange:n=>{const c=n?Object.keys(n)[0]:null;if(c&&d.getFieldError(c).length){const u={name:c,errors:[]};d.setFields([u])}},disabled:p,scrollToFirstError:!0,children:f(_,{direction:"vertical",size:"middle",style:{display:"flex"},className:"px-2",children:[e(_,{style:{display:"flex",justifyContent:"right",paddingBlock:"8px"},children:e(i.Item,{style:{marginBottom:0},children:e(S,{type:"primary",htmlType:"submit",loading:p,children:"Update"})})}),f(w,{title:t("URL and Path"),children:[e(i.Item,{label:"Root Path",name:"root_folder_path",tooltip:`${t("Root folder path must be correct. Default: ")}${a==null?void 0:a.root_folder_path}`,rules:[{required:!0,message:t("Root folder is required")}],children:e(b,{})}),e(i.Item,{label:"Root URL",name:"root_folder_url",tooltip:`${t("Root folder URL must be correct. Default: ")}${a==null?void 0:a.root_folder_url}`,rules:[{pattern:new RegExp(`^${a==null?void 0:a.root_folder_url}(?:/[^/]+)*/?`),message:t("The root URL must be within this site")}],children:e(b,{})}),e(i.Item,{label:t("Root Folder Name"),name:"root_folder_name",rules:[{pattern:/^[a-z A-Z 0-9 -]*$/,message:t("The root drive can contain letters, numbers and -")}],children:e(b,{})})]}),f(w,{title:t("File Manager Settings"),children:[e(i.Item,{label:t("Select Language"),name:"language",children:e(r,{value:o==null?void 0:o.language,children:m==null?void 0:m.map(n=>e(r.Option,{value:n.code,children:n.name},n.code))})}),e(i.Item,{label:t("Select Theme"),name:"theme",children:e(r,{children:s==null?void 0:s.map(n=>e(r.Option,{value:n.key,children:n.title},n.key))})}),f(w,{title:t("Size"),children:[e(i.Item,{label:"Width",name:["size","width"],tooltip:"File Manager window width (in px)",rules:[{pattern:/^(auto|[0-9]+)$/,message:t("Width can be integer or auto")}],children:e(b,{})}),e(i.Item,{label:"Height",name:["size","height"],tooltip:"File Manager window height (in px)",rules:[{pattern:/^(auto|[0-9]+)$/,message:t("Height can be integer or auto")}],children:e(b,{})})]}),e(i.Item,{label:t("Sync with media library"),name:"wp_media_sync",tooltip:t("If this is enabled and target upload path is within Wordpress upload directory then, files uploaded using file manager will be visible in WordPress media library"),children:e(h,{})}),e(i.Item,{label:t("Show Hidden Files"),name:"show_hidden_files",children:e(h,{})}),e(i.Item,{label:t("Allow Create/Upload Hidden Files/Folders"),name:"create_hidden_files_folders",children:e(h,{})}),e(i.Item,{label:t("Allow Trash"),name:"create_trash_files_folders",children:e(h,{})}),e(i.Item,{label:t("Display UI options"),name:"display_ui_options",children:f(r,{mode:"multiple",children:[e(r.Option,{value:"toolbar",children:"Toolbar"}),e(r.Option,{value:"places",children:"Places"}),e(r.Option,{value:"tree",children:"Tree"}),e(r.Option,{value:"path",children:"Path"}),e(r.Option,{value:"stat",children:"Stat"})]})}),e(i.Item,{label:t("Remember Last Directory"),name:"remember_last_dir",tooltip:t("Remember last opened dir to open it after reload."),children:e(h,{})}),e(i.Item,{label:t("Clear History On Reload"),name:"clear_history_on_reload",tooltip:t("Clear history's(elFinder) on reload(not browser)"),children:e(h,{})}),e(i.Item,{label:t("Default View Type"),name:"default_view_type",children:f(r,{children:[e(r.Option,{value:"icons",children:"Icons"}),e(r.Option,{value:"list",children:"List"})]})}),e(i.Item,{label:"Show Link and Path",name:"show_url_path",tooltip:t("If this is enabled then, Link and path will be shown in file, folder info."),children:e(h,{})})]}),e(_,{style:{display:"flex",justifyContent:"center"},children:e(i.Item,{children:e(S,{type:"primary",htmlType:"submit",loading:p,children:"Update"})})})]})})}export{q as default};
